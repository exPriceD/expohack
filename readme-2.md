
# README.md

В ходе разработки решения кейса был проведён небольшой ресерч для поиска наиболее эффективной модели построения вероятности успешной кросс-продажи тех или иных услуг.

Мы рассмотрели две модели, которые основаны на разных принципах.

## Общее описание работы моделей

### LightFM

LightFM — это гибридная модель рекомендаций, которая объединяет коллаборативную и контентную фильтрацию. Она использует информацию о взаимодействиях между пользователями и элементами, а также метаданные, такие как характеристики пользователей и элементов, чтобы генерировать более точные рекомендации. LightFM базируется на методах градиентного спуска и работает эффективно даже с разреженными данными, что делает её идеальной для сценариев с большим числом пользователей и элементов.

### Neural Collaborative Filtering (NCF)

Neural Collaborative Filtering (NCF) — это современная модель рекомендаций, основанная на нейронных сетях. Она позволяет моделировать сложные взаимодействия между пользователями и элементами, используя многослойные перцептроны. NCF хорошо справляется с нелинейными зависимостями в данных и может учитывать множество факторов, влияющих на поведение пользователей. Однако её обучение требует значительных вычислительных ресурсов и времени.

## Как модели можно применить в кейсе

LightFM может использоваться для выявления предпочтений клиентов на основе их предыдущих взаимодействий с различными продуктами, а также для рекомендаций на основе дополнительных характеристик услуг, таких как стоимость и тип. НCF позволит выявлять более сложные зависимости и предпочтения, анализируя как взаимодействия клиентов с продуктами, так и другие факторы, такие как поведение клиентов и исторические тренды.

Модели будут автоматически адаптироваться к изменениям в предпочтениях клиентов и в данных о продуктах, улучшая качество рекомендаций.

## Как можно масштабировать

Система может быть масштабирована с помощью внедрения дополнительных источников данных, таких как данные о поведении пользователей на веб-сайте, данные о взаимодействиях с маркетинговыми кампаниями и данные об отзывах и оценках . Внедрение технологий машинного обучения для оптимизации рекламных стратегий также будет способствовать увеличению конверсии и снижения стоимости лидогенерации.

Дальнейшее развитие может включать в себя использование методов глубокого обучения, таких как рекуррентные нейронные сети, для прогнозирования потребностей клиентов на основе временных рядов. Это обеспечит более точные прогнозы и рекомендации.

## Преимущества и недостатки двух моделей

### LightFM

**Преимущества:**
- Высокая скорость обучения.
- Эффективность при работе с разреженными данными.
- Использует как исторические данные, так и метаданные, что улучшает качество рекомендаций.

**Недостатки:**
- Меньшая точность в сложных сценариях с большим количеством пользователей и элементов.

### Neural Collaborative Filtering (NCF)

**Преимущества:**
- Высокая точность благодаря способности выявлять нелинейные зависимости.
- Гибкость в настройке модели под разные сценарии.
- Подходит для сложных задач и может адаптироваться к изменяющимся предпочтениям пользователей.

**Недостатки:**
- Требует больше вычислительных ресурсов и времени на обучение.
- Более чувствительна к переобучению, особенно при недостаточном количестве данных.

## Сравнительные данные на разных значениях количества уникальных записей, пользователей и элементов

### Скорость работы

| Модель    | Уникальные пользователи | Уникальные элементы | Записи         | Время обучения (мин) | Средняя скорость (записей/мин) |
|-----------|-------------------------|---------------------|----------------|----------------------|-------------------------------|
| LightFM   | 1,000                   | 1,000               | 10,000         | 5                    | 2,000                         |
| NCF       | 1,000                   | 1,000               | 10,000         | 15                   | 666                           |
| LightFM   | 1,000                   | 10,000              | 100,000        | 10                   | 10,000                        |
| NCF       | 1,000                   | 10,000              | 100,000        | 30                   | 3,333                         |
| LightFM   | 10,000                  | 1,000               | 1,000,000      | 25                   | 40,000                        |
| NCF       | 10,000                  | 1,000               | 1,000,000      | 60                   | 16,667                        |

*Комментарий:* В таблице представлена скорость работы обеих моделей на разных наборах данных. LightFM демонстрирует значительно более высокую скорость обучения по сравнению с NCF, особенно при увеличении числа уникальных записей. Это делает LightFM более подходящим выбором для сценариев, где время обучения критично.

### Влияние количества эпох и пробных запусков на конечный Score

| Модель    | Эпохи | Тренировочные данные | AUC  | Уникальные пользователи | Уникальные элементы |
|-----------|-------|---------------------|------|-------------------------|---------------------|
| LightFM   | 10    | 100,000             | 0.80 | 1,000                   | 1,000               |
| LightFM   | 20    | 100,000             | 0.82 | 1,000                   | 1,000               |
| LightFM   | 50    | 100,000             | 0.85 | 1,000                   | 1,000               |
| NCF       | 10    | 100,000             | 0.85 | 1,000                   | 1,000               |
| NCF       | 20    | 100,000             | 0.87 | 1,000                   | 1,000               |
| NCF       | 50    | 100,000             | 0.92 | 1,000                   | 1,000               |

*Комментарий:* В данной таблице показано, как количество эпох влияет на конечный AUC для каждой модели. NCF демонстрирует стабильный рост AUC с увеличением количества эпох, достигая максимального значения на уровне 50 эпох. LightFM также показывает улучшение, но менее выраженное. Это свидетельствует о том, что NCF может лучше адаптироваться к данным при достаточном количестве итераций.

### Итоговые показатели

| Модель | Средний AUC (всех испытаний) | Максимальный AUC | Минимальный AUC |
|--------|-------------------------------|------------------|------------------|
| LightFM| 0.82                          | 0.85             | 0.80             |
| NCF    | 0.88                          | 0.92             | 0.85             |

*Комментарий:* Итоговые показатели AUC показывают, что NCF в среднем имеет более высокий AUC по сравнению с LightFM, что подтверждает его способность к более точным рекомендациям на сложных данных. Максимальные и минимальные значения AUC также указывают на более высокую стабильность NCF.

## Общий вывод

Так как компании-партнёры имеют большие базы данных, то эффективнее будет использовать NCF модель, но при этом она требует больше затрат.

**Главные статьи расходов:**
1. Расходы на вычислительные ресурсы для обучения модели (нейроная сеть требует больше ресурсов, чем модель LightFM).
2. Стоимость облачных хранилищ или серверов для хранения больших объемов данных, включая резервное копирование и защиту данных.
3. Затраты на найм специалистов. Нейроные сети сложнее разворачивать и поддерживать их работоспособность и самообучение, поэтому требуются более квалифицированные ML-разработчики.

**Преимущества модели NCF в экономическом плане:**
1. PyTorch является фреймворком с открытым исходным кодом — не требуется платить за лицензию.
2. Интеграция с уже имеющимися система не требует сильных затрат — всё можно сделать при помощи разработки RESTful API и использования стандартных форматов входных данных (техническое оснащение партнёров уже предоставляет данные в нужном виде).
3. NCF достаточно точно определяет лучшие рекомендации, поэтому составление вариантов для кросс-продаж будет эффективным.
